<script>
let shops = {};
let currentShop = "";
let stock = 0;
let monthIn = 0;
let monthOut = 0;

function addShop(){
  const name = document.getElementById("newShop").value.trim();
  if(name === ""){
    alert("દુકાન નામ લખો");
    return;
  }
  if(!shops[name]){
    shops[name] = { data: [], stock:0, in:0, out:0 };
  }
  document.getElementById("newShop").value="";
  renderShops();
}

function renderShops(){
  const sel = document.getElementById("shopSelect");
  sel.innerHTML = "<option value=''>-- દુકાન પસંદ કરો --</option>";
  for(let s in shops){
    sel.innerHTML += `<option value="${s}">${s}</option>`;
  }
}

function loadShopData(){
  currentShop = document.getElementById("shopSelect").value;
  if(currentShop==="") return;

  const shop = shops[currentShop];
  stock = shop.stock;
  monthIn = shop.in;
  monthOut = shop.out;

  document.getElementById("data").innerHTML = "";
  shop.data.forEach(r=>{
    document.getElementById("data").innerHTML += `
      <tr>
        <td>${r.date}</td>
        <td>${r.in}</td>
        <td>${r.out}</td>
        <td class="total">${r.balance}</td>
      </tr>`;
  });

  document.getElementById("totalIn").innerText = monthIn;
  document.getElementById("totalOut").innerText = monthOut;
  document.getElementById("totalBalance").innerText = stock;
}

function addData(){
  if(currentShop===""){
    alert("પહેલા દુકાન પસંદ કરો");
    return;
  }

  const date = document.getElementById("date").value;
  const inMilk = Number(document.getElementById("inMilk").value || 0);
  const outMilk = Number(document.getElementById("outMilk").value || 0);

  if(date===""){
    alert("તારીખ પસંદ કરો");
    return;
  }

  stock = stock + inMilk - outMilk;
  monthIn += inMilk;
  monthOut += outMilk;

  const record = {
    date: date,
    in: inMilk,
    out: outMilk,
    balance: stock
  };

  shops[currentShop].data.push(record);
  shops[currentShop].stock = stock;
  shops[currentShop].in = monthIn;
  shops[currentShop].out = monthOut;

  document.getElementById("totalIn").innerText = monthIn;
  document.getElementById("totalOut").innerText = monthOut;
  document.getElementById("totalBalance").innerText = stock;

  document.getElementById("data").innerHTML += `
    <tr>
      <td>${date}</td>
      <td>${inMilk}</td>
      <td>${outMilk}</td>
      <td class="total">${stock}</td>
    </tr>`;

  document.getElementById("inMilk").value="";
  document.getElementById("outMilk").value="";
}
</script>
